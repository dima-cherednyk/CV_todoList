(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{24:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(13),o=n(2),i=n.n(o),s=n(4),u=n(3),l="https://mate.academy/students-api";function d(e){return new Promise((function(t){setTimeout(t,e)}))}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),d(300).then((function(){return fetch(l+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var p,j=function(e){return f(e)},b=function(e,t){return f(e,"POST",t)},m=function(e,t){return f(e,"PATCH",t)},h=function(e){return f(e,"DELETE")},O=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",j("/todos?userId=".concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b("/todos",t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h("/todos/".concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(s.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("/todos/".concat(t),{completed:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=Object(s.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",m("/todos/".concat(t),{title:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=n(5),T=n.n(N),w=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.name,e.abrupt("return",b("/users",{email:n,name:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=n(0),_=function(e){var t=e.onLogin,n=Object(r.useState)(""),a=Object(u.a)(n,2),c=a[0],o=a[1],l=Object(r.useState)(""),d=Object(u.a)(l,2),f=d[0],p=d[1],j=Object(r.useState)(!1),b=Object(u.a)(j,2),m=b[0],h=b[1],O=Object(r.useState)(!1),v=Object(u.a)(O,2),x=v[0],g=v[1],y=Object(r.useState)(""),N=Object(u.a)(y,2),_=N[0],C=N[1],A=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(r.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(r){}}),[]);var E=function(){var e=Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(c);case 2:(t=e.sent)?A(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),C(""),g(!0),e.prev=3,!m){e.next=9;break}return e.next=7,k({name:f,email:c}).then(A);case 7:e.next=11;break;case 9:return e.next=11,E();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),C("Something went wrtong");case 16:return e.prev=16,g(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsxs)("form",{onSubmit:F,className:"box mt-5",children:[Object(S.jsx)("h1",{className:"title is-3",children:m?"You need to register":"Log in to open todos"}),Object(S.jsxs)("div",{className:"field",children:[Object(S.jsxs)("label",{className:"label",htmlFor:"user-email",children:["Email",Object(S.jsxs)("div",{className:T()("control has-icons-left",{"is-loading":x}),children:[Object(S.jsx)("input",{type:"email",id:"user-email",className:T()("input",{"is-danger":!m&&_}),placeholder:"Enter your email",disabled:x||m,value:c,required:!0,onChange:function(e){return o(e.target.value)}}),Object(S.jsx)("span",{className:"icon is-small is-left",children:Object(S.jsx)("i",{className:"fas fa-envelope"})})]})]}),!m&&_&&Object(S.jsx)("p",{className:"help is-danger",children:_})]}),m&&Object(S.jsxs)("div",{className:"field",children:[Object(S.jsxs)("label",{className:"label",htmlFor:"user-name",children:["Your Name",Object(S.jsxs)("div",{className:T()("control has-icons-left",{"is-loading":x}),children:[Object(S.jsx)("input",{type:"text",id:"user-name",className:T()("input",{"is-danger":m&&_}),placeholder:"Enter your name",required:!0,minLength:4,disabled:x,value:f,onChange:function(e){return p(e.target.value)}}),Object(S.jsx)("span",{className:"icon is-small is-left",children:Object(S.jsx)("i",{className:"fas fa-user"})})]})]}),m&&_&&Object(S.jsx)("p",{className:"help is-danger",children:_})]}),Object(S.jsx)("div",{className:"field",children:Object(S.jsx)("button",{type:"submit",className:T()("button is-primary",{"is-loading":x}),children:m?"Register":"Login"})})]})},C=a.a.createContext(null),A=function(e){var t=e.children,n=Object(r.useState)(null),a=Object(u.a)(n,2),c=a[0],o=a[1];return c?Object(S.jsx)(C.Provider,{value:c,children:t}):Object(S.jsx)(_,{onLogin:o})};!function(e){e.active="active",e.completed="completed",e.all="all"}(p||(p={}));var E,F=function(e){var t=e.todos,n=e.deleteCompleted,r=e.filterTodos,a=e.filterOption,c=e.isAdding;return Object(S.jsx)(S.Fragment,{children:(t.length>0||c)&&Object(S.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(S.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(t.filter((function(e){return!e.completed})).length," items left")}),Object(S.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(S.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:T()("filter__link",{selected:a===p.all}),onClick:function(){return r(p.all)},children:"All"}),Object(S.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:T()("filter__link",{selected:a===p.active}),onClick:function(){return r(p.active)},children:"Active"}),Object(S.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:T()("filter__link",{selected:a===p.completed}),onClick:function(){return r(p.completed)},children:"Completed"})]}),Object(S.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:T()("todoapp__clear-completed",{"is-invisible":t.every((function(e){return!e.completed}))}),onClick:function(){return n()},children:"Clear completed"})]})})},D=function(e){var t=e.newTodoField,n=e.todos,a=e.toNameTodo,c=e.isAdding,o=e.toggleAll,i=Object(r.useState)(""),s=Object(u.a)(i,2),l=s[0],d=s[1];return Object(S.jsxs)("header",{className:"todoapp__header",children:[n.length>0&&Object(S.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:T()("todoapp__toggle-all",{active:n.every((function(e){return e.completed}))}),"aria-label":"ToggleAllButton",onClick:o}),Object(S.jsx)("form",{onSubmit:function(e){e.preventDefault(),a(l),d("")},children:Object(S.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:t,className:"todoapp__new-todo",placeholder:"What needs to be done?",onChange:function(e){d(e.target.value)},value:l,disabled:c})})]})},L=function(e){var t=e.errorText,n=e.closeNotification;return Object(S.jsxs)("div",{"data-cy":"ErrorNotification",className:T()("notification is-danger is-light has-text-weight-normal",{hidden:0===t.length}),children:[Object(S.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete","aria-label":"HideErrorButton",onClick:function(){return n()}}),"empty"===t?"Title can't be empty":"Unable to ".concat(t," a todo")]})},B=function(e){var t=e.notification,n=e.errorText,r=e.closeNotification;return Object(S.jsx)(S.Fragment,{children:"error"===t&&Object(S.jsx)(L,{errorText:n,closeNotification:r})})},I=n(33),J=n(32),P=function(e){var t=e.todo,n=e.removeOneTodo,a=e.todoAction,c=e.changeOneTodoStatus,o=e.editTodo,i=e.editingTodo,s=e.changeTitle,l=Object(r.useState)(""),d=Object(u.a)(l,2),f=d[0],p=d[1],j=Object(r.useState)(!1),b=Object(u.a)(j,2),m=b[0],h=b[1],O=Object(r.useRef)(null);Object(r.useEffect)((function(){O.current&&O.current.focus()}),[m]);var v=function(e){return e.preventDefault(),o(0,""),f===t.title?null:f?s(i,f):n(i)};return Object(S.jsxs)("div",{"data-cy":"Todo",className:T()("todo",{completed:t.completed}),children:[Object(S.jsx)("label",{htmlFor:String(t.id),className:"todo__status-label",children:Object(S.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",id:String(t.id),onChange:function(){return c(t.id,!t.completed)}})}),i===t.id?Object(S.jsx)("form",{onSubmit:v,onBlur:v,children:Object(S.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",defaultValue:t.title,onChange:function(e){p(e.target.value)},onKeyDown:function(e){"Escape"===e.code&&o(0,"")},ref:O})}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){o(t.id,t.title),p(t.title),h(!m)},children:t.title}),Object(S.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){return n(t.id)},children:"\xd7"})]}),a.length>0&&Object(S.jsxs)("div",{"data-cy":"TodoLoader",className:T()("modal overlay",{"is-active":a.includes(t.id)}),children:[Object(S.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(S.jsx)("div",{className:"loader"})]})]},t.id)},R=(n(24),function(e){var t=e.todos,n=e.removeOneTodo,r=e.todoAction,a=e.isAdding,c=e.newTodoName,o=e.user,i=e.changeOneTodoStatus,s=e.editTodo,u=e.editingTodo,l=e.changeTitle;return o?Object(S.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:Object(S.jsxs)(I.a,{children:[t.map((function(e){return Object(S.jsx)(J.a,{timeout:300,classNames:"item",children:Object(S.jsx)(P,{todo:e,removeOneTodo:n,todoAction:r,changeOneTodoStatus:i,editTodo:s,editingTodo:u,changeTitle:l})},e.id)})),a&&Object(S.jsx)(J.a,{timeout:300,classNames:"item",children:Object(S.jsx)(P,{todo:{id:0,title:c,completed:!1,userId:o.id,createdAt:new Date,updatedAt:new Date},todoAction:[0],removeOneTodo:n,changeOneTodoStatus:i,editTodo:s,editingTodo:Math.random(),changeTitle:l})},0)]})}):null});!function(e){e.success="success",e.error="error",e.null="null"}(E||(E={}));var H=function(){var e=Object(r.useContext)(C),t=Object(r.useRef)(null),n=Object(r.useState)([]),a=Object(u.a)(n,2),c=a[0],o=a[1],l=Object(r.useState)(E.null),d=Object(u.a)(l,2),f=d[0],j=d[1],b=Object(r.useState)(""),m=Object(u.a)(b,2),h=m[0],N=m[1],T=Object(r.useState)(p.all),w=Object(u.a)(T,2),k=w[0],_=w[1],A=Object(r.useState)([]),L=Object(u.a)(A,2),I=L[0],J=L[1],P=Object(r.useState)(!1),H=Object(u.a)(P,2),q=H[0],M=H[1],U=Object(r.useState)(""),Y=Object(u.a)(U,2),G=Y[0],K=Y[1],V=Object(r.useState)(0),W=Object(u.a)(V,2),z=W[0],Q=W[1];Object(r.useEffect)((function(){(function(){var t=Object(s.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e){t.next=6;break}return t.next=4,O(e.id);case 4:n=t.sent,o(n);case 6:t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),j(E.error),N("load");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}})()(),t.current&&t.current.focus()}),[]),Object(r.useEffect)((function(){t.current&&t.current.focus()}),[q]);var X=function(){j(E.null),N("")},Z=function(){var t=Object(s.a)(i.a.mark((function t(){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=7;break}return t.next=3,O(e.id);case 3:n=t.sent,M(!1),o(n),J([]);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),$=function(){var n=Object(s.a)(i.a.mark((function n(r){var a,c,o,s;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",null);case 2:if(r){n.next=5;break}return N("empty"),n.abrupt("return",j(E.error));case 5:return K(r),M(!0),n.next=9,O(e.id);case 9:return a=n.sent,c=0===a.length?e.id:a[a.length-1].id+1,X(),t.current&&t.current.focus(),n.prev=13,o={id:c,userId:e.id,completed:!1,title:r,createdAt:new Date,updatedAt:new Date},n.next=17,v(o);case 17:return s=n.sent,Z(),n.abrupt("return",s);case 22:return n.prev=22,n.t0=n.catch(13),J([]),M(!1),N("add"),n.abrupt("return",j(E.error));case 28:case"end":return n.stop()}}),n,null,[[13,22]])})));return function(e){return n.apply(this,arguments)}}(),ee=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(),e.prev=1,e.next=4,x(t);case 4:return n=e.sent,Z(),e.abrupt("return",n);case 9:return e.prev=9,e.t0=e.catch(1),J([]),N("delete"),e.abrupt("return",j(E.error));case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),te=Object(r.useMemo)((function(){switch(X(),k){case p.active:return c.filter((function(e){return!e.completed}));case p.completed:return c.filter((function(e){return e.completed}));case p.all:default:return c}}),[c,k]),ne=function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(),e.prev=1,e.next=4,g(t,n);case 4:return r=e.sent,Z(),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(1),J([]),N("update"),e.abrupt("return",j(E.error));case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}(),re=function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(),e.prev=1,e.next=4,y(t,n);case 4:return r=e.sent,J([t]),Z(),e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(1),J([]),N("update"),e.abrupt("return",j(E.error));case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}();return f!==E.null&&setTimeout(X,3e3),Object(S.jsxs)("div",{className:"todoapp",children:[Object(S.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(S.jsxs)("div",{className:"todoapp__content",children:[Object(S.jsx)(D,{newTodoField:t,todos:c,toNameTodo:$,isAdding:q,toggleAll:function(){return c.every((function(e){return e.completed}))?(J(c.map((function(e){return e.id}))),c.forEach((function(e){ne(e.id,!1)}))):(J(c.filter((function(e){return!e.completed})).map((function(e){return e.id}))),c.filter((function(e){return!e.completed})).forEach((function(e){ne(e.id,!0)})))}}),Object(S.jsx)(R,{todos:te,removeOneTodo:function(e){J([e]),ee(e)},todoAction:I,isAdding:q,newTodoName:G,user:e,changeOneTodoStatus:function(e,t){J([e]),ne(e,t)},editTodo:function(e,t){Q(e),K(t)},editingTodo:z,changeTitle:re}),Object(S.jsx)(F,{todos:c,deleteCompleted:function(){return J(c.filter((function(e){return e.completed})).map((function(e){return e.id}))),c.filter((function(e){return e.completed})).forEach((function(e){ee(e.id)}))},filterTodos:function(e){return _(e)},filterOption:k,isAdding:q})]}),Object(S.jsx)(B,{notification:f,errorText:h,closeNotification:X})]})},q=(n(27),n(28),n(29),function(){return Object(S.jsx)(A,{children:Object(S.jsx)(H,{})})});Object(c.createRoot)(document.getElementById("root")).render(Object(S.jsx)(q,{}))}},[[30,1,2]]]);
//# sourceMappingURL=main.59156534.chunk.js.map